---
import { literal } from "astro/zod";
import { getBlogs } from "../library/microcms";

const { contents: posts } = await getBlogs({
  fields: ["id", "title", "publishedAt", "eyecatch"],
});
---

<div class="card-list">
  <ul>
    {
      posts.map((post) => (
        <li class="card-body">
          <a href={`/blog/${post.id}`}>
            <img class="post-image" src={post.eyecatch.url} alt={post.title} />
            <div class="card-bottom">
              <h3>{post.title}</h3>
            </div>
          </a>
        </li>
      ))
    }
  </ul>
</div>
<style lang="scss">
  $mq-breakpoints: (
    xl: 1440px,
    lg: 1280px,
    md: 1024px,
    tb: 768px,
    sm: 576px,
    xs: 414px,
  ) !default;

  @mixin mq($breakpoint: md, $rule: min, $subtraction: false) {
    $breakpoint: map-get($mq-breakpoints, $breakpoint);

    @if $rule==max and $subtraction {
      $breakpoint: $breakpoint - 0.0625;
    }

    @media screen and (#{$rule}-width: $breakpoint) {
      @content;
    }
  }
  .card-body {
    border-radius: 0.5rem;
    max-width: 100%;
    margin-bottom: 16px;
    list-style: none;
    border-bottom: 4px solid #d3d3d3;
    & a {
      @include mq(xs) {
        display: grid;
        grid-template-columns: 4fr 8fr;
        grid-template-areas: "figure section";
        grid-template-rows: 10rem;
        border-radius: 0.3rem;
        border: 1px solid #d3d3d3;
      }
    }
  }

  .post-image {
    width: 100%;
    height: auto;
    border-radius: 0.5rem 0.5rem 0 0;
    @include mq(xs) {
      grid-area: figure;
      width: auto;
      height: 100%;
      border-radius: 0.2rem 0 0 0.2rem;
    }
  }
  .card-bottom {
    padding: 0 1rem;
    @include mq(xs) {
      grid-area: section;
    }
  }
  h3 {
    font-size: 20px;
  }

  ul {
    padding-left: 0;
  }
  a {
    text-decoration: none;
  }
</style>

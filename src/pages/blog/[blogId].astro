---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getBlogs, getBlogDetail } from "../../library/microcms";

export async function getStaticPaths() {
  const response = await getBlogs({ fields: ["id"] });
  return response.contents.map((content: any) => ({
    params: {
      blogId: content.id,
    },
  }));
}

const { blogId } = Astro.params;
const blog = await getBlogDetail(blogId as string);
---

<BaseLayout pageTitle={blog.title}>
  <img
    src={blog.eyecatch?.url ?? ""}
    alt="eyecatch"
    width={blog.eyecatch.width}
    height={blog.eyecatch.height}
  />
  <h1>{blog.title}</h1>
  <time datetime={blog.publishedAt}>
    {new Date(blog.publishedAt).toLocaleDateString("ja-JP")}
  </time>
  <p>
    Last updated at <time datetime={blog.publishedAt}>
      {new Date(blog.publishedAt).toLocaleDateString("ja-JP")}
    </time>
  </p>
  <hr />
  <main set:html={blog.content} />
</BaseLayout>
